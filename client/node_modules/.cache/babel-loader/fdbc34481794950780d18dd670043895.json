{"ast":null,"code":"import _objectSpread from\"/Users/sikollineu-iandeulei/Desktop/Userslist/usersList/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/sikollineu-iandeulei/Desktop/Userslist/usersList/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{paginate}from\"../../../utils/paginate\";import Pagination from\"../../common/pagination\";import GroupList from\"../../common/groupList\";import SearchStatus from\"../../ui/searchStatus\";import UserTable from\"../../ui/usersTable\";import _ from\"lodash\";import{getProfessions,getProfessionsLoadingStatus}from\"../../../store/professions\";import{useSelector}from\"react-redux\";import{getCurrentUserId,getUsersList}from\"../../../store/users\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UsersListPage=function UsersListPage(){var users=useSelector(getUsersList());var currentUserId=useSelector(getCurrentUserId());var professions=useSelector(getProfessions());var professionsLoading=useSelector(getProfessionsLoadingStatus());var _useState=useState(1),_useState2=_slicedToArray(_useState,2),currentPage=_useState2[0],setCurrentPage=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),searchQuery=_useState4[0],setSearchQuery=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),selectedProf=_useState6[0],setSelectedProf=_useState6[1];var _useState7=useState({path:\"name\",order:\"asc\"}),_useState8=_slicedToArray(_useState7,2),sortBy=_useState8[0],setSortBy=_useState8[1];var pageSize=8;var handleDelete=function handleDelete(userId){};var handleToggleBookMark=function handleToggleBookMark(id){var newArray=users.map(function(user){if(user._id===id){return _objectSpread(_objectSpread({},user),{},{bookmark:!user.bookmark});}return user;});// setUsers(newArray);\nconsole.log(newArray);};useEffect(function(){setCurrentPage(1);},[selectedProf,searchQuery]);var handleProfessionSelect=function handleProfessionSelect(item){if(searchQuery!==\"\")setSearchQuery(\"\");setSelectedProf(item);};var handleSearchQuery=function handleSearchQuery(_ref){var target=_ref.target;setSelectedProf(undefined);setSearchQuery(target.value);};var handlePageChange=function handlePageChange(pageIndex){setCurrentPage(pageIndex);};var handleSort=function handleSort(item){setSortBy(item);};function filterUsers(data){var filteredUsers=searchQuery?data.filter(function(user){return user.name.toLowerCase().indexOf(searchQuery.toLowerCase())!==-1;}):selectedProf?data.filter(function(user){return user.profession===selectedProf._id;}):data;return filteredUsers.filter(function(u){return u._id!==currentUserId;});}var filteredUsers=filterUsers(users);var count=filteredUsers.length;var sortedUsers=_.orderBy(filteredUsers,[sortBy.path],[sortBy.order]);var usersCrop=paginate(sortedUsers,currentPage,pageSize);var clearFilter=function clearFilter(){setSelectedProf();};return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",children:[professions&&!professionsLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column flex-shrink-0 p-3\",children:[/*#__PURE__*/_jsx(GroupList,{selectedItem:selectedProf,items:professions,onItemSelect:handleProfessionSelect}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary mt-2\",onClick:clearFilter,children:\"\\u041E\\u0447\\u0438\\u0441\\u0442\\u0438\\u0442\\u0442\\u044C\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column\",children:[/*#__PURE__*/_jsx(SearchStatus,{length:count}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"searchQuery\",placeholder:\"Search...\",onChange:handleSearchQuery,value:searchQuery}),count>0&&/*#__PURE__*/_jsx(UserTable,{users:usersCrop,onSort:handleSort,selectedSort:sortBy,onDelete:handleDelete,onToggleBookMark:handleToggleBookMark}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(Pagination,{itemsCount:count,pageSize:pageSize,currentPage:currentPage,onPageChange:handlePageChange})})]})]});};export default UsersListPage;","map":{"version":3,"names":["React","useState","useEffect","paginate","Pagination","GroupList","SearchStatus","UserTable","_","getProfessions","getProfessionsLoadingStatus","useSelector","getCurrentUserId","getUsersList","UsersListPage","users","currentUserId","professions","professionsLoading","currentPage","setCurrentPage","searchQuery","setSearchQuery","selectedProf","setSelectedProf","path","order","sortBy","setSortBy","pageSize","handleDelete","userId","handleToggleBookMark","id","newArray","map","user","_id","bookmark","console","log","handleProfessionSelect","item","handleSearchQuery","target","undefined","value","handlePageChange","pageIndex","handleSort","filterUsers","data","filteredUsers","filter","name","toLowerCase","indexOf","profession","u","count","length","sortedUsers","orderBy","usersCrop","clearFilter"],"sources":["/Users/sikollineu-iandeulei/Desktop/Userslist/usersList/client/src/app/components/page/usersListPage/usersListPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { paginate } from \"../../../utils/paginate\";\nimport Pagination from \"../../common/pagination\";\nimport GroupList from \"../../common/groupList\";\nimport SearchStatus from \"../../ui/searchStatus\";\nimport UserTable from \"../../ui/usersTable\";\nimport _ from \"lodash\";\nimport {\n    getProfessions,\n    getProfessionsLoadingStatus\n} from \"../../../store/professions\";\nimport { useSelector } from \"react-redux\";\nimport { getCurrentUserId, getUsersList } from \"../../../store/users\";\nconst UsersListPage = () => {\n    const users = useSelector(getUsersList());\n    const currentUserId = useSelector(getCurrentUserId());\n\n    const professions = useSelector(getProfessions());\n    const professionsLoading = useSelector(getProfessionsLoadingStatus());\n    const [currentPage, setCurrentPage] = useState(1);\n    const [searchQuery, setSearchQuery] = useState(\"\");\n    const [selectedProf, setSelectedProf] = useState();\n    const [sortBy, setSortBy] = useState({ path: \"name\", order: \"asc\" });\n    const pageSize = 8;\n\n    const handleDelete = (userId) => {};\n    const handleToggleBookMark = (id) => {\n        const newArray = users.map((user) => {\n            if (user._id === id) {\n                return { ...user, bookmark: !user.bookmark };\n            }\n            return user;\n        });\n        // setUsers(newArray);\n        console.log(newArray);\n    };\n\n    useEffect(() => {\n        setCurrentPage(1);\n    }, [selectedProf, searchQuery]);\n\n    const handleProfessionSelect = (item) => {\n        if (searchQuery !== \"\") setSearchQuery(\"\");\n        setSelectedProf(item);\n    };\n    const handleSearchQuery = ({ target }) => {\n        setSelectedProf(undefined);\n        setSearchQuery(target.value);\n    };\n\n    const handlePageChange = (pageIndex) => {\n        setCurrentPage(pageIndex);\n    };\n    const handleSort = (item) => {\n        setSortBy(item);\n    };\n\n    function filterUsers(data) {\n        const filteredUsers = searchQuery\n            ? data.filter(\n                  (user) =>\n                      user.name\n                          .toLowerCase()\n                          .indexOf(searchQuery.toLowerCase()) !== -1\n              )\n            : selectedProf\n            ? data.filter((user) => user.profession === selectedProf._id)\n            : data;\n        return filteredUsers.filter((u) => u._id !== currentUserId);\n    }\n    const filteredUsers = filterUsers(users);\n    const count = filteredUsers.length;\n    const sortedUsers = _.orderBy(filteredUsers, [sortBy.path], [sortBy.order]);\n    const usersCrop = paginate(sortedUsers, currentPage, pageSize);\n    const clearFilter = () => {\n        setSelectedProf();\n    };\n\n    return (\n        <div className=\"d-flex\">\n            {professions && !professionsLoading && (\n                <div className=\"d-flex flex-column flex-shrink-0 p-3\">\n                    <GroupList\n                        selectedItem={selectedProf}\n                        items={professions}\n                        onItemSelect={handleProfessionSelect}\n                    />\n                    <button\n                        className=\"btn btn-secondary mt-2\"\n                        onClick={clearFilter}\n                    >\n                        Очиститть\n                    </button>\n                </div>\n            )}\n            <div className=\"d-flex flex-column\">\n                <SearchStatus length={count} />\n                <input\n                    type=\"text\"\n                    name=\"searchQuery\"\n                    placeholder=\"Search...\"\n                    onChange={handleSearchQuery}\n                    value={searchQuery}\n                />\n                {count > 0 && (\n                    <UserTable\n                        users={usersCrop}\n                        onSort={handleSort}\n                        selectedSort={sortBy}\n                        onDelete={handleDelete}\n                        onToggleBookMark={handleToggleBookMark}\n                    />\n                )}\n                <div className=\"d-flex justify-content-center\">\n                    <Pagination\n                        itemsCount={count}\n                        pageSize={pageSize}\n                        currentPage={currentPage}\n                        onPageChange={handlePageChange}\n                    />\n                </div>\n            </div>\n        </div>\n    );\n};\nUsersListPage.propTypes = {\n    users: PropTypes.array\n};\n\nexport default UsersListPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}